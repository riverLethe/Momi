# 记账APP需求规格说明书

## 1. 引言

本文档旨在详细定义一款创新的记账应用程序（APP）的需求。该APP的核心目标是简化个人及家庭财务管理过程，特别是消费账单的记录、共享与分析。通过引入基于人工智能（AI）的账单解析功能，结合直观的用户界面、多样化的数据输入方式以及**轻量化的、隐式共享的家庭协同记账特性**，本APP致力于为用户提供一个高效、准确且易于使用的财务助手。其设计将优先考虑跨平台兼容性，确保在iOS和Android设备上均能提供一致且优质的用户体验。

## 2. 目标用户

本APP的目标用户群体包括希望有效跟踪个人支出、理解消费习惯的智能手机用户，并扩展至希望共同管理家庭财务、**自动共享**账单信息的家庭单位。用户可能不具备专业的财务知识，因此APP的易用性和直观性至关重要，尤其是在处理家庭账单的自动共享和查看方面。

## 3. 总体描述

### 3.1 产品定位

该记账APP定位为一个跨平台的移动应用程序，初期将支持iOS和Android两大主流操作系统。它旨在成为用户个人及家庭日常财务管理的得力助手，通过智能化的账单录入、清晰的消费数据可视化以及**便捷的、隐式的家庭账单共享功能**，帮助用户轻松掌握财务状况。

### 3.2 产品特性

APP的核心特性围绕账单的便捷录入、智能化处理以及**自动化的家庭账单共享**展开。用户可以通过一个创新的多轮对话聊天框界面输入个人账单信息，支持文本、图片（如购物小票）、CSV文件以及Excel表格等多种格式。内置的AI引擎将负责解析这些输入，自动提取关键账单信息如金额、商户、日期和消费类别，力求达到90%的解析准确率。对于AI解析可能存在的偏差，账单录入者可以方便地对已生成的账单条目进行手动调整或完全手动创建新账单。

核心特性调整为**隐式家庭共享**：用户可以创建或加入一个“家庭空间”。**一旦用户成为家庭空间的成员，其在该家庭空间上下文中创建的所有账单都将自动对该家庭空间内的所有其他成员可见，无需用户进行任何手动“共享”操作。** 消费情况将通过多样化的图表和数据汇总进行呈现，支持“个人”和“家庭”两种视图。**账单的修改和删除权限简化为：只有账单的原始录入者才有权修改或删除该账单，其他家庭成员对非自己录入的家庭账单仅有查看权限。** APP还将集成轻量化的个人预算管理以及账单数据导出功能。

### 3.3 用户特征

目标用户普遍熟悉智能手机操作，期望通过APP简化生活中的繁琐事务。他们偏好快速、高效的解决方案。对于财务数据，用户重视隐私和准确性。在家庭共享场景下，用户期望能够透明地、自动地共享信息，同时操作简单，不涉及复杂的权限配置或手动的共享步骤。

### 3.4 设计与实现约束

AI解析账单的准确率是关键性能指标，目标设定为90%。家庭账单的自动同步需要保证及时性和数据一致性。简化的权限控制（创建者可编辑，他人只读）必须严格执行。附加功能如预算管理和账单导出，应保持轻量化设计。设计图初期将以低保真线框图的形式呈现。

## 4. 详细需求

### 4.1 功能需求

#### 4.1.1 账单录入模块

##### 4.1.1.1 聊天机器人智能录入
用户可以通过聊天机器人界面进行账单录入。支持文本、图片、CSV/Excel文件。AI引擎解析输入，提取账单要素。若用户当前激活了某个家庭空间，则通过此方式录入的账单将自动成为该家庭空间的账单。

##### 4.1.1.2 AI账单解析与用户校正
AI引擎识别账单信息。解析后，账单创建者可以对结果进行修改。AI准确率目标90%。

##### 4.1.1.3 手动添加与编辑账单
用户可通过表单手动添加新账单。表单包含日期、金额、商户、类别、支付账户、备注等。**若用户已加入并激活了某个家庭空间，其通过此表单创建的账单将自动与该家庭空间关联，并在家庭视图中对所有成员可见，无需用户进行额外的共享选择操作。**
**权限控制：只有账单的原始录入者才有权编辑或删除其创建的账单。其他家庭成员在查看非自己创建的家庭账单时，编辑和删除操作将被禁用或隐藏。**

#### 4.1.2 消费分析与展示模块

##### 4.1.2.1 关键数据指标展示
系统分析并展示关键支出数据指标。**数据维度：用户可以通过切换视图，选择查看“个人”账单的分析结果（用户自己创建的所有账单），或“家庭”账单的汇总分析结果（当前激活家庭空间内所有成员创建的账单）。**

##### 4.1.2.2 动态图表可视化
消费分析结果通过多种图表呈现。**数据范围：用户可以选择查看基于个人账单的图表或基于家庭账单的汇总图表。**

##### 4.1.2.3 数据筛选与排序
用户可对账单数据和分析结果进行筛选和排序。例如，按时间、类别筛选。
**视图切换下的筛选：**
*   **个人视图**：筛选条件作用于当前用户创建的所有账单。
*   **家庭视图**：筛选条件作用于当前激活家庭空间内所有成员创建的账单。可以按“创建者”（即家庭成员）进行筛选。

#### 4.1.3 预算管理模块 (轻量化 - 针对个人)

提供基础的预算管理功能，帮助用户规划和控制个人支出。此功能仅针对个人账单（即用户自己创建的账单，不区分是否在家庭空间内）。

##### 4.1.3.1 个人预算设置
用户可以为自己的消费类别或总支出设置月度预算。

##### 4.1.3.2 个人预算跟踪与提醒
APP根据用户个人记录的账单自动跟踪预算执行情况并提醒。

#### 4.1.4 轻量化家庭共享功能 (隐式共享模型)

此模块实现家庭协同记账的核心，设计力求简洁易用，账单共享为自动机制。

##### 4.1.4.1 家庭空间创建与加入
用户可以创建一个“家庭空间”（例如，输入家庭名称），并自动成为该空间的成员。用户也可以通过邀请码或链接加入一个已存在的家庭空间。一个用户可以属于多个家庭空间，但通常在某个激活的家庭空间上下文中操作。

##### 4.1.4.2 家庭成员查看与基本管理 (简化)
家庭空间的创建者（或首个加入者）可以邀请其他用户加入。家庭空间内成员可以看到其他成员列表。创建者可以移除成员。成员可以主动退出家庭空间。

##### 4.1.4.3 隐式账单共享机制
**当家庭空间的任何成员创建一笔账单时（无论通过聊天机器人还是手动录入），该账单将自动与当前用户激活的家庭空间关联，并对该家庭空间内的所有其他成员可见。用户无需进行任何手动的“共享”操作或选择。** 所有家庭成员创建的账单构成了家庭空间的共享账单池。

##### 4.1.4.4 账单操作规则 (核心简化)
*   **创建者权限**：账单的原始录入者（创建者）拥有对该账单的完全编辑和删除权限。
*   **其他成员权限**：对于非自己创建的家庭账单，其他家庭成员仅有查看权限，不能进行编辑或删除操作。

##### 4.1.4.5 账单列表的个人/家庭筛选
在账单列表页面，用户应能方便地筛选查看：“我的账单”（仅显示当前用户创建的所有账单）或“家庭账单 - [家庭名称]”（显示当前激活家庭空间内所有成员创建的全部账单）。

##### 4.1.4.6 统计分析的个人/家庭视图切换
在消费分析与展示模块，用户可以清晰地切换数据分析的视角：“个人视角”（基于“我的账单”数据进行分析）或“家庭视角 - [家庭名称]”（基于当前激活家庭空间的所有成员创建的全部账单进行汇总分析）。

#### 4.1.5 账单导出模块 (轻量化)

##### 4.1.5.1 导出格式与范围
支持CSV或PDF格式。用户可选时间范围。
**导出内容：**
*   **个人数据导出**：导出当前用户创建的所有账单。
*   **家庭数据导出**：导出当前激活家庭空间的所有成员创建的全部账单。此操作对所有家庭成员开放。

### 4.2 用户界面需求

UI设计简洁直观。家庭共享相关的操作，如切换个人/家庭视图等，需易于理解和操作。**账单的共享是自动且隐式的，界面上不应出现手动“共享”账单的选项或开关。** 账单的只读与可编辑状态应有清晰视觉区分。

### 4.3 数据需求

核心数据实体包括：User, FamilySpace, FamilyMemberLink, Transaction, Category, PaymentAccount (个人), Budget (个人)。
Transaction 实体需包含 `creator_user_id` 和 `family_space_id` (nullable, 用于关联到特定家庭空间) 字段。当用户在激活的家庭空间内创建账单时，`family_space_id` 会被自动填充。

### 4.4 非功能性需求

性能、可靠性（AI准确率90%，数据同步一致性）、易用性（家庭功能简化，隐式共享）、安全性（数据加密，简化权限准确执行）等保持不变。

## 5. 系统架构 (高层次)

系统架构保持前端、AI解析服务、后端核心服务、数据库层的划分。后端核心服务层将实现简化的家庭空间管理、**隐式的账单共享逻辑**和基于创建者的权限控制。

